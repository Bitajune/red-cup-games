{% extends 'base.html' %} {% block content %}

<h1>Game Details</h1>

<div class="row">
  <div class="col s6 col-offset-3">
    <div class="card">
      <div class="card-content">
        <span class="card-title">{{ redcup.name }}</span>
        <p>Rules: {{ redcup.rules }}</p>
        <p>Players: {{ redcup.players }}</p>
        <p>
          Link:
          <a href="{{ redcup.link }}" target="_blank">{{ redcup.link }}</a>
        </p>
        <p>User: {{ redcup.user.username }}</p>
      </div>
      {% if user.username == redcup.user.username %}
      <div class="card-action">
        <a href="{% url 'redcup_update' redcup.id %}">Edit</a>
        <a href="{% url 'redcup_delete' redcup.id %}">Delete</a>
      </div>
      {% endif %}
    </div>
  </div>
</div>
{% for photo in redcup.photo_set.all %}
      <img class="responsive-img card-panel" src="{{photo.url}}">
    {% empty %}
      <div class="card-panel teal-text center-align">No Photos Uploaded</div>
    {% endfor %}
    <form action="{% url 'add_photo' redcup.id %}" enctype="multipart/form-data" method="POST" class="card-panel">
      {% csrf_token %}
      <input type="file" name="photo-file">
      <br><br>
      <input type="submit" class="btn" value="Upload Photo">
    </form>
    <div class="card-action">
      <a class="btn" href="{% url 'photo_delete' redcup.id %}">Delete Photo</a>
    </div>
<div class="col s6">
  <form action="{% url 'add_comment' redcup.id %}" method="post">
    {% csrf_token %} {{ comment_form.as_p }}
    <input type="submit" class="btn" value="Add A Comment" />
  </form>
  <table class="striped">
    <thead>
      <tr>
        <th>Date</th>
        <th>User</th>
        <th>Comment</th>
      </tr>
    </thead>
    <tbody>
      {% for comment in redcup.comment_set.all %}
      <tr>
        <td>{{comment.created_date}}</td>
        <td>{{comment.user.username}}</td>
        {% if user.username == comment.user.username %}
        <td>
          <form action="{% url 'comment_update' comment.id%}" method="post">
            {{comment.comment}} {% csrf_token %} {{ comment_form.as_p }}</td>
            <td><input type="submit" class="btn" value="Update Comment" />
          </form>
        </td>
        <td><a href="{% url 'comment_delete' comment.id %}">Delete</a></td>
        {% else %}
        <td>{{comment.comment}}</td>
        {% endif %} {% endfor %}
      </tr>
    </tbody>
  </table>

  <div class="card-action"></div>
</div>
{% endblock %}
